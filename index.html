<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>BONANZA - The Real Auction Grind</title>
    <style>
        :root { --gold: #d4af37; --red: #8b0000; --dark: #0a0a0a; --pork: #ffafcc; }
        body { background: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }

        /* √âCRAN DE S√âLECTION */
        #setup-screen { position: fixed; inset: 0; background: var(--dark); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 20px solid var(--red); }
        .mode-card { background: #111; border: 2px solid var(--gold); padding: 30px; margin: 10px; cursor: pointer; width: 300px; text-align: center; transition: 0.3s; }
        .mode-card:hover { background: var(--red); transform: scale(1.05); }

        .header { width: 100%; padding: 15px 40px; background: linear-gradient(to bottom, #222, #000); border-bottom: 2px solid var(--gold); display: flex; justify-content: space-between; box-sizing: border-box; }
        .casino-container { margin-top: 50px; padding: 30px; background: var(--red); border: 10px solid var(--gold); border-radius: 20px; box-shadow: 0 0 50px rgba(212,175,55,0.3); }
        .reels-view { display: flex; gap: 15px; background: #000; padding: 15px; height: 120px; overflow: hidden; border: 5px solid #111; }
        .reel-track { width: 100px; display: flex; flex-direction: column; }
        .symbol { width: 100px; height: 120px; display: flex; align-items: center; justify-content: center; font-size: 3.5rem; flex-shrink: 0; }
        
        .sym-B { background: radial-gradient(circle, #2b4cd6, #000); border: 2px solid #5a7fff; }
        .sym-N { background: radial-gradient(circle, #d62b2b, #000); border: 2px solid #ff5a5a; }
        .sym-Z { background: radial-gradient(circle, #2bd64c, #000); border: 2px solid #5aff7f; }

        .spin-btn { margin-top: 30px; padding: 20px 80px; background: var(--gold); color: #000; font-size: 1.8rem; font-weight: 900; border: none; cursor: pointer; border-radius: 5px; box-shadow: 0 6px 0 #8a6d0d; }
        .spin-btn:active { transform: translateY(3px); box-shadow: 0 3px 0 #8a6d0d; }
        .spin-btn:disabled { background: #444; color: #777; box-shadow: none; }

        #pork-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.98); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        .pork-speech { background: #fff; color: #000; padding: 30px; max-width: 500px; border-left: 10px solid var(--gold); text-align: center; border-radius: 0 20px 20px 0; }
        .countdown { font-size: 8rem; color: var(--gold); font-weight: 900; }
    </style>
</head>
<body>

    <div id="setup-screen">
        <h1 style="color:var(--gold); font-size: 2.5rem; text-align:center; margin-bottom: 40px;">BONANZA AUCTION HOUSE<br><span style="font-size: 1.2rem; color: white;">Endure les gages pour gagner des jetons pour l'ench√®re de minuit</span></h1>
        <div class="mode-card" onclick="initGame('SOLO')">
            <h2>MODE SOLO</h2>
            <p>D√©fis personnels.<br>Gains BNZ : 15 Jetons IRL</p>
        </div>
        <div class="mode-card" onclick="initGame('EQUIPE')">
            <h2>MODE √âQUIPE</h2>
            <p>Duels et jeux de groupe.<br>Gains BNZ : 25 Jetons IRL</p>
        </div>
    </div>

    <div class="header">
        <div>Bonanza <span id="mode-label" style="color:var(--gold)"></span></div>
        <div style="color:var(--gold); font-weight: bold;">CASINO OUVERT</div>
    </div>

    <div class="casino-container">
        <div class="reels-view">
            <div class="reel-track" id="r0"><div class="symbol">üé∞</div></div>
            <div class="reel-track" id="r1"><div class="symbol">üé∞</div></div>
            <div class="reel-track" id="r2"><div class="symbol">üé∞</div></div>
        </div>
    </div>

    <button id="spin-btn" class="spin-btn" onclick="play()">LANCER LE DESTIN</button>

    <div id="pork-modal">
        <div id="pork-timer" class="countdown">3</div>
        <div id="pork-body" style="display:none; text-align:center;">
            <div style="font-size:80px; margin-bottom:20px;">üê∑</div>
            <div class="pork-speech">
                <h2 id="gage-title" style="text-transform: uppercase; color: var(--red);"></h2>
                <p id="gage-desc" style="font-size: 1.2rem; line-height: 1.4;"></p>
                <p id="pork-insult" style="color: #666; font-style: italic; margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px;"></p>
            </div>
            <button style="margin-top:30px; padding:15px 40px; background: var(--gold); border:none; font-weight:bold; cursor:pointer; font-size: 1.2rem;" onclick="closePork()">C'EST FAIT, JE REJOUE</button>
        </div>
    </div>

<script>
    let gameMode = "";
    const fruits = ['üç∫', 'üíÄ', 'üî•', 'üÉè', 'üçå', 'üçí', 'üçã'];

    const GAGES_SOLO = {
        DOUBLE: [
            { t: "CUL-SEC PARTIEL", d: "La machine a soif. Bois la moiti√© de ton verre imm√©diatement." },
            { t: "LE SAVANT", d: "Cite 5 villes d'un pays en 10s. √âchec : tu bois 5 gorg√©es. R√©ussite : tu ne bois rien." },
            { t: "R√âSISTANCE", d: "Interdiction de boire de l'eau ou de t'asseoir pendant 10 min. Faute : 4 gorg√©es." },
            { t: "LE MUET", d: "Silence radio jusqu'√† ton prochain tour de jeu. Chaque mot prononc√© te co√ªte 2 gorg√©es." }
        ],
        TRIPLE: [
            { t: "EXTINCTEUR", d: "Le casino surchauffe ! Finis ton verre cul-sec pour √©teindre l'incendie." },
            { t: "L'OFFRANDE", d: "John Pork exige un sacrifice. Pr√©pare et bois un shot m√©langeant deux alcools diff√©rents." }
        ],
        BNZ: [{ t: "BONANZA JACKPOT", d: "INCROYABLE ! John Pork te donne 15 JETONS IRL pour l'ench√®re. Note-les bien !" }]
    };

    const GAGES_EQUIPE = {
        DOUBLE: [
            { t: "LA CIBLE", d: "D√©signe une personne. Elle doit encaisser 4 gorg√©es pour te laisser continuer." },
            { t: "JEU DE LA SYLLABE", d: "Dis un mot. Le suivant utilise la derni√®re syllabe. Le premier qui bloque boit 4 gorg√©es." },
            { t: "FINGERS", d: "Dernier doigt pos√© sur la table boit 5 gorg√©es." },
            { t: "MARQUE", d: "Donne un th√®me (ex: Marques de luxe). Le premier qui s√®che boit 4 gorg√©es." }
        ],
        TRIPLE: [
            { t: "LE DICTATEUR", d: "Tu as le plein pouvoir. Choisis 2 personnes : elles finissent leur verre." },
            { t: "D√âCRET ROYAL", d: "R√®gle pour tous (ex: pas de pr√©noms). Chaque erreur constat√©e = 2 gorg√©es." }
        ],
        BNZ: [{ t: "BONANZA JACKPOT", d: "LE JACKPOT ! Ton √©quipe ou toi gagnez 25 JETONS IRL pour l'ench√®re. Vous √™tes riches !" }]
    };

    const insults = [
        "Fais √ßa vite sinon tu d√©gages de mon casino !",
        "Allez les gros lards, on s'active !",
        "Tu croyais que les jetons tombaient du ciel ?",
        "Bois et ferme-la, le prochain tour arrive.",
        "Mon casino, mes r√®gles. Sant√© !"
    ];

    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    function beep(f, d) {
        const o = ctx.createOscillator(); const g = ctx.createGain();
        o.frequency.value = f; g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+d);
        o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+d);
    }

    function initGame(mode) {
        gameMode = mode;
        document.getElementById('mode-label').innerText = mode;
        document.getElementById('setup-screen').style.display = 'none';
    }

    async function play() {
        document.getElementById('spin-btn').disabled = true;

        const luck = Math.random();
        let res = [];
        // Probabilit√©s : Jackpot 3%, Triple 10%, Double 35%, Perte 52%
        if(luck < 0.03) res = ['B', 'N', 'Z'];
        else if(luck < 0.13) { const s = fruits[Math.floor(Math.random()*7)]; res = [s, s, s]; }
        else if(luck < 0.48) { 
            const s = fruits[Math.floor(Math.random()*7)]; 
            let s2; do { s2 = fruits[Math.floor(Math.random()*7)]; } while(s2===s);
            res = [s, s, s2].sort(()=>Math.random()-0.5); 
        }
        else { 
            let s1, s2, s3;
            do {
                s1 = fruits[Math.floor(Math.random()*7)];
                s2 = fruits[Math.floor(Math.random()*7)];
                s3 = fruits[Math.floor(Math.random()*7)];
            } while(s1 === s2 || s2 === s3 || s1 === s3);
            res = [s1, s2, s3]; 
        }

        const anims = [0,1,2].map(id => spin(id, res[id]));
        await Promise.all(anims);
        setTimeout(() => check(res), 500);
    }

    function spin(id, target) {
        return new Promise(resolve => {
            const track = document.getElementById('r'+id);
            const count = 25 + (id * 5);
            track.innerHTML = '';
            for(let i=0; i<count; i++) {
                const div = document.createElement('div');
                const s = (i === count - 1) ? target : fruits[Math.floor(Math.random()*7)];
                div.innerText = s;
                div.className = `symbol ${['B','N','Z'].includes(s) ? 'sym-'+s : ''}`;
                track.appendChild(div);
            }
            track.style.transition = 'none';
            track.style.transform = 'translateY(0)';
            track.offsetHeight;
            track.style.transition = `transform ${1.5 + id*0.5}s cubic-bezier(0.1, 0, 0, 1)`;
            track.style.transform = `translateY(-${(count-1)*120}px)`;
            setTimeout(() => { beep(200+(id*100), 0.2); resolve(); }, 1500 + id*500);
        });
    }

    async function check(res) {
        let type = "";
        if (res[0]==='B' && res[1]==='N' && res[2]==='Z') type = "BNZ";
        else if (res[0] === res[1] && res[1] === res[2]) type = "TRIPLE";
        else if (res[0] === res[1] || res[1] === res[2] || res[0] === res[2]) type = "DOUBLE";

        if(type !== "") {
            const pool = (gameMode === "SOLO" ? GAGES_SOLO : GAGES_EQUIPE)[type];
            const ev = pool[Math.floor(Math.random()*pool.length)];

            document.getElementById('pork-body').style.display = 'none';
            document.getElementById('pork-timer').style.display = 'block';
            document.getElementById('pork-modal').style.display = 'flex';

            for(let i=3; i>0; i--) {
                document.getElementById('pork-timer').innerText = i;
                beep(400, 0.1);
                await new Promise(r => setTimeout(r, 600));
            }
            
            document.getElementById('pork-timer').style.display = 'none';
            document.getElementById('gage-title').innerText = ev.t;
            document.getElementById('gage-desc').innerText = ev.d;
            document.getElementById('pork-insult').innerText = "John Pork : \"" + insults[Math.floor(Math.random()*insults.length)] + "\"";
            document.getElementById('pork-body').style.display = 'block';
        } else {
            document.getElementById('spin-btn').disabled = false;
        }
    }

    function closePork() {
        document.getElementById('pork-modal').style.display = 'none';
        document.getElementById('spin-btn').disabled = false;
    }
</script>
</body>
</html>
