<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>BNZ : WARIO EDITION</title>
    <style>
        body { font-family: 'Arial Black', sans-serif; background: #000; color: white; margin: 0; overflow: hidden; }
        
        /* Dashboard discret en haut */
        .dashboard { display: flex; justify-content: space-between; padding: 10px 20px; background: #111; border-bottom: 2px solid #333; }
        #chips-display { color: gold; font-size: 1.5rem; }

        /* Slot Machine */
        .machine-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 80vh; }
        .reels { display: flex; gap: 15px; margin-bottom: 30px; }
        .reel { width: 100px; height: 130px; background: #222; border: 4px solid #444; border-radius: 10px; font-size: 3.5rem; display: flex; align-items: center; justify-content: center; }

        .btn-spin { padding: 25px 80px; font-size: 2rem; background: gold; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; }
        .btn-spin:disabled { background: #333; color: #555; }

        /* POPUP GAGE (Style WarioWare) */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 100;
        }

        #countdown { font-size: 12rem; font-weight: 900; color: #ff0000; }
        
        #gage-card {
            background: #fff; color: #000; padding: 40px; border-radius: 20px;
            width: 80%; max-width: 600px; text-align: center;
            box-shadow: 0 0 50px gold; display: none;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }

        .gage-type { font-size: 1.5rem; text-transform: uppercase; background: #000; color: #fff; padding: 5px 15px; display: inline-block; margin-bottom: 20px; }
        .gage-title { font-size: 2.5rem; margin-bottom: 20px; display: block; }
        .gage-desc { font-size: 1.8rem; font-family: sans-serif; line-height: 1.2; }

        /* Animation de d√©faite */
        #refill-btn { padding: 30px; background: red; color: white; border: none; font-size: 2rem; cursor: pointer; display: none; }
    </style>
</head>
<body>

    <div class="dashboard">
        <div id="chips-display">CHIPS: 100</div>
        <div id="status">WARIO MODE</div>
    </div>

    <div class="machine-container">
        <div class="reels">
            <div class="reel" id="r0">?</div>
            <div class="reel" id="r1">?</div>
            <div class="reel" id="r2">?</div>
        </div>
        <button id="spin-btn" class="btn-spin" onclick="play()">SPIN</button>
        <button id="refill-btn" onclick="refill()">BOIS TON SHOT ET RECLIQUE</button>
    </div>

    <div id="overlay">
        <div id="countdown">3</div>
        <div id="gage-card">
            <div id="gage-tag" class="gage-type">DOUBLE</div>
            <b id="gage-name" class="gage-title">NOM DU GAGE</b>
            <div id="gage-info" class="gage-desc">Description du gage ici.</div>
            <br>
            <button onclick="closeGage()" style="padding:10px 20px; cursor:pointer; margin-top:20px;">OK !</button>
        </div>
    </div>

<script>
    let chips = 100;
    const fruitSyms = ['üç∫', 'üíÄ', 'üî•', 'üÉè', 'üçå', 'üçí', 'üçã'];

    const EVENTS = {
        DOUBLE: [
            { t: "CIBLE", d: "Donne 2 gorg√©es √† ton voisin de gauche." },
            { t: "MIROIR", d: "Choisis un partenaire : s'il boit, tu bois." },
            { t: "SYLLABE", d: "Suite de mots (Bateau -> Tonneau). Le premier qui bloque boit." },
            { t: "LE SAVANT", d: "Cite 5 villes d'un pays en 10s ou bois 3 fois." },
            { t: "C'EST QUI ?", d: "√Ä 3, tout le monde pointe celui qui est le plus '...'. Le plus d√©sign√© boit." },
            { t: "SANT√â", d: "Tout le monde boit une gorg√©e, sauf toi." },
            { t: "FINGERS", d: "Jeu du doigt sur le verre : le dernier boit." },
            { t: "MARQUE", d: "Donne une marque de voiture. Le premier qui s√®che boit." },
            { t: "VETO", d: "Annule la prochaine gorg√©e que tu devrais prendre." }
        ],
        TRIPLE: [
            { t: "DICTATEUR", d: "D√©signe 3 personnes qui doivent finir leur verre." },
            { t: "CASCADE", d: "Lance une cascade g√©n√©rale." },
            { t: "D√âCRET ROYAL", d: "Invente une r√®gle interdite. Le premier qui faut boit." },
            { t: "L'ENCH√àRE", d: "Celui qui accepte de boire le plus de gorg√©es √©chappe au shot." },
            { t: "ESCLAVE", d: "La personne √† ta droite te sert pendant 20 min." },
            { t: "BUFFLE", d: "Interdiction de boire de la main forte." },
            { t: "PYRAMIDE", d: "Distribue 5 gorg√©es dans le groupe." },
            { t: "CRACKLIST", d: "Th√®me : 'S√©ries Netflix'. Le premier qui s√®che boit." },
            { t: "ROI", d: "Personne ne peut te regarder dans les yeux sans boire." },
            { t: "TOUR DE TABLE", d: "Une anecdote. Ceux qui l'ont d√©j√† fait boivent." }
        ],
        BNZ: [{ t: "LE SAINT GRAAL", d: "üî• GAGNE 10 JETONS IRL üî•" }]
    };

    async function play() {
        if (chips < 10) return;
        chips -= 10;
        updateUI();
        document.getElementById('spin-btn').disabled = true;

        // Tirage (Identique aux specs pr√©c√©dentes)
        let res = [];
        const rng = Math.random();
        if (rng < 0.02) res = ['B', 'N', 'Z'];
        else if (rng < 0.07) { const s = fruitSyms[Math.floor(Math.random()*7)]; res = [s, s, s]; }
        else if (rng < 0.37) { const s = fruitSyms[Math.floor(Math.random()*7)]; res = [s, s, fruitSyms[0]]; }
        else res = ['B', fruitSyms[1], fruitSyms[2]];

        // Animation rapide
        for(let i=0; i<3; i++) {
            await new Promise(r => setTimeout(r, 150));
            document.getElementById(`r${i}`).innerText = res[i];
        }

        processResult(res);
    }

    async function play() {
    if (chips < 10) return;
    
    // 1. Reset visuel imm√©diat pour casser l'impression de blocage
    for(let i=0; i<3; i++) {
        document.getElementById(`r${i}`).innerText = "üé≤"; 
        document.getElementById(`r${i}`).style.opacity = "0.5";
    }

    chips -= 10;
    updateUI();
    document.getElementById('spin-btn').disabled = true;

    let res = ["", "", ""];
    const luck = Math.random();

    // 2. Tirage du sc√©nario
    if (luck < 0.02) { 
        // JACKPOT BNZ
        res = ['B', 'N', 'Z']; 
    } 
    else if (luck < 0.08) { 
        // TRIPLE (On force 3 symboles identiques parmis les fruits)
        const s = fruitSyms[Math.floor(Math.random() * fruitSyms.length)];
        res = [s, s, s];
    } 
    else if (luck < 0.38) { 
        // DOUBLE (On force une paire et un intrus diff√©rent)
        const s = fruitSyms[Math.floor(Math.random() * fruitSyms.length)];
        let other;
        do { other = fruitSyms[Math.floor(Math.random() * fruitSyms.length)]; } while (other === s);
        
        res = [s, s, other];
        res.sort(() => Math.random() - 0.5); // On m√©lange l'ordre de la paire
    } 
    else {
        // PERTE TOTALE (On force 3 symboles diff√©rents ET on √©vite B-N-Z)
        let s1, s2, s3;
        do {
            s1 = Math.random() > 0.5 ? 'B' : fruitSyms[Math.floor(Math.random() * fruitSyms.length)];
            s2 = Math.random() > 0.5 ? 'N' : fruitSyms[Math.floor(Math.random() * fruitSyms.length)];
            s3 = Math.random() > 0.5 ? 'Z' : fruitSyms[Math.floor(Math.random() * fruitSyms.length)];
        } while (
            (s1 === s2 || s2 === s3 || s1 === s3) || // Pas de doubles
            (s1 === 'B' && s2 === 'N' && s3 === 'Z') // Pas de jackpot BNZ par erreur
        );
        res = [s1, s2, s3];
    }

    // 3. Animation de "roulement" pour confirmer que √ßa change
    for(let i=0; i<3; i++) {
        await new Promise(r => setTimeout(r, 100)); // D√©lai entre chaque case
        const el = document.getElementById(`r${i}`);
        el.innerText = res[i];
        el.style.opacity = "1";
        // Petit effet de scale pour le feedback visuel
        el.style.transform = "scale(1.1)";
        setTimeout(() => { el.style.transform = "scale(1)"; }, 50);
    }

    processResult(res);
}

    function closeGage() {
        document.getElementById('overlay').style.display = 'none';
        if (chips < 10) showGameOver();
        else document.getElementById('spin-btn').disabled = false;
    }

    function showGameOver() {
        document.getElementById('spin-btn').style.display = 'none';
        document.getElementById('refill-btn').style.display = 'block';
    }

    function refill() {
        chips = 100;
        updateUI();
        document.getElementById('spin-btn').style.display = 'block';
        document.getElementById('refill-btn').style.display = 'none';
        document.getElementById('spin-btn').disabled = false;
    }

    function updateUI() { document.getElementById('chips-display').innerText = "CHIPS: " + chips; }
</script>
</body>
</html>
